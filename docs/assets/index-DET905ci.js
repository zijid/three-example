import{r as k,j as w}from"./index-Buk_76b2.js";import{A as F,B as I,j as V,M as D,Q as q,E as N,b as O}from"./OrbitControls-T7DR67G2.js";import{W as Q}from"./three.utils-CYtmvWls.js";function J({onChange:L=()=>{}}){const m=k.useRef(null);return k.useEffect(()=>{const n=m.current,E=[];if(n){let y=function(){R.splice(0)},h=function(e,r){R.push({x:e,y:r})},M=function(){t.beginPath(),R.forEach(({x:e,y:r})=>{t.beginPath(),t.arc(e,r,5,0,2*Math.PI),t.stroke()})},u=function(e){return typeof e=="number"},a=function(){i={start:{x:null,y:null},end:{x:null,y:null}}},x=function(){if(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,window.innerWidth,window.innerHeight),t.fillStyle=c.bgColor,t.fillRect(0,0,n.width,n.height),t.setTransform(1,0,0,1,s.x,s.y),t.strokeStyle="red",t.setLineDash([]),t.lineWidth=1,t.beginPath(),P.forEach(({start:e,end:r})=>{t.moveTo(e.x,e.y),t.lineTo(r.x,r.y)}),u(i.start.x)&&u(i.start.y)&&u(i.end.x)&&u(i.end.y)){{const e=n.getBoundingClientRect();let r=p.clientX-e.x,o=p.clientY-e.y;const d=s.width,T=s.height;r=d-r,o=T-o;const l=-c.movePixel;r<100?s.x+=l:r>d-100&&(s.x-=l),o<100?s.y+=l:o>T-100&&(s.y-=l)}j(p),t.moveTo(i.start.x,i.start.y),t.lineTo(i.end.x,i.end.y)}t.stroke(),M(),G()},f=function(){requestAnimationFrame(f),x()},v=function(e){return Math.round((e-s.x)/c.interval)*c.interval},g=function(e){return Math.round((e-s.y)/c.interval)*c.interval},b=function(e,r){i.end.x=e,i.end.y=r},G=function(){const e=s.x%c.interval,r=s.y%c.interval;t.setTransform(1,0,0,1,e,r),t.strokeStyle="#00ffff",t.setLineDash([2,10,10,10]),t.lineWidth=.3;for(var o=c.interval,d=window.innerHeight/o+2,T=window.innerWidth/o+2,l=0;l<=d;l++)t.beginPath(),t.moveTo(-c.interval*2,l*o),t.lineTo(n.width+c.interval*2,l*o),t.stroke();for(var l=0;l<=T;l++)t.beginPath(),t.moveTo(l*o,-c.interval*2),t.lineTo(l*o,n.height+c.interval*2),t.stroke()},X=function(){n.width=window.innerWidth,n.height=window.innerHeight,s.width=n.width,s.height=n.height};n.width=window.innerWidth,n.height=window.innerHeight;const t=n.getContext("2d"),c={bgColor:"#282828",isSetBgColor:!0,interval:50,movePixel:10,edgeMovement:!0,pointToGrid:!0,offset:10,point:!1},P=[],R=[];t.fillStyle="red",t.lineWidth=1,t.strokeStyle="red";let s={x:0,y:0,width:window.innerWidth,height:window.innerHeight};const p={clientX:null,clientY:null};let i={start:{x:null,y:null},end:{x:null,y:null}};f();let C=!1,W=!1,S={x:null,y:null};const Y=e=>{const r=n.getBoundingClientRect(),o=v(e.clientX-r.x),d=g(e.clientY-r.y);S.x=o,S.y=d,B?W=!0:(C=!0,i.start.x=o,i.start.y=d,h(o,d))},z=e=>{W=!1,C=!1;const r=n.getBoundingClientRect(),o=v(e.clientX-r.x),d=g(e.clientY-r.y);!u(i.start.x)&&!u(i.start.y)||(b(o,d),i.start.x===i.end.x&&i.start.y===i.end.y||P.push(i),a(),y(),L(P))},j=e=>{const r=n.getBoundingClientRect();p.clientX=e.clientX,p.clientY=e.clientY;const o=v(e.clientX-r.x),d=g(e.clientY-r.y);if(W)s.x-=S.x-o,s.y-=S.y-d;else{if(!u(i.start.x)&&!u(i.start.y))return;b(o,d),C&&(y(),h(i.start.x,i.start.y),h(i.end.x,i.end.y))}};let B=!1;const A=e=>{e.code==="Space"&&(B=!0)},H=e=>{e.code==="Space"&&(B=!1)};n.addEventListener("mousedown",Y),n.addEventListener("mouseup",z),n.addEventListener("mousemove",j),n.addEventListener("keydown",A),n.addEventListener("keyup",H),window.addEventListener("resize",X),E.push(()=>{n.removeEventListener("mousedown",Y),n.removeEventListener("mouseup",z),n.removeEventListener("mousemove",j),n.removeEventListener("keydown",A),n.removeEventListener("keyup",H),window.removeEventListener("resize",X)})}return()=>{E.forEach(y=>y())}},[]),w.jsx("canvas",{ref:m,style:{display:"block",width:"100%",height:"100%"}})}function _(){const L=k.useRef(null);let m,n,E;k.useEffect(()=>{const h=L.current,M=[];if(h){const a=new Q(h);a.init(),a.update(),a.updateSize(),a.addOrbitControls(),{scene:m,camera:n,renderer:E}=a,n.position.set(0,0,1e3);const x=new F(4210752,10);a.createModel(x),n.lookAt(0,0,0);const f=new I(1,1,1),v=new V({color:16711680});new D(f,v)}return[{start:{x:450,y:400},end:{x:450,y:550}},{start:{x:450,y:550},end:{x:750,y:550}}].forEach(({start:a,end:x})=>{const f=new q;f.moveTo(a.x,a.y),f.lineTo(x.x,x.y);const v={depth:100,bevelEnabled:!0,bevelSegments:2,steps:2,bevelSize:1,bevelThickness:1},g=new N(f,v),b=new D(g,new O({color:"red"}));m.add(b)}),()=>{M.forEach(a=>a())}},[]);function y(h){console.log("list:",h)}return w.jsxs(w.Fragment,{children:[w.jsx("canvas",{style:{display:"block",width:"100vw",height:"100vh"},ref:L}),w.jsx("div",{style:{display:"block",width:"100vw",height:"100vh",position:"absolute",top:0,left:0,zIndex:1},children:w.jsx(J,{onChange:y})})]})}export{_ as default};
