import{g as Br}from"./index--S1ByAj9.js";import{w as Ce,u as se,o as He,H as Ve,U as sr,n as _e,V as fe,_ as zr,b as qr}from"./OrbitControls-T7DR67G2.js";import{P as cr,F as Zr,C as jr}from"./OutputPass-CzP49YQB.js";function kr(o,a){for(var e=0;e<a.length;e++){const f=a[e];if(typeof f!="string"&&!Array.isArray(f)){for(const g in f)if(g!=="default"&&!(g in o)){const x=Object.getOwnPropertyDescriptor(f,g);x&&Object.defineProperty(o,g,x.get?x:{enumerable:!0,get:()=>f[g]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}function he(o,a,e){this.k=o,this.x=a,this.y=e}he.prototype={constructor:he,scale:function(o){return o===1?this:new he(this.k*o,this.x,this.y)},translate:function(o,a){return o===0&a===0?this:new he(this.k,this.x+this.k*o,this.y+this.k*a)},apply:function(o){return[o[0]*this.k+this.x,o[1]*this.k+this.y]},applyX:function(o){return o*this.k+this.x},applyY:function(o){return o*this.k+this.y},invert:function(o){return[(o[0]-this.x)/this.k,(o[1]-this.y)/this.k]},invertX:function(o){return(o-this.x)/this.k},invertY:function(o){return(o-this.y)/this.k},rescaleX:function(o){return o.copy().domain(o.range().map(this.invertX,this).map(o.invert,o))},rescaleY:function(o){return o.copy().domain(o.range().map(this.invertY,this).map(o.invert,o))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};he.prototype;function Wr(o,a){function e(){this.constructor=o}e.prototype=a.prototype,o.prototype=new e}function ce(o,a,e,f){this.message=o,this.expected=a,this.found=e,this.location=f,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ce)}Wr(ce,Error);ce.buildMessage=function(o,a){var e={literal:function(c){return'"'+g(c.text)+'"'},class:function(c){var h="",m;for(m=0;m<c.parts.length;m++)h+=c.parts[m]instanceof Array?x(c.parts[m][0])+"-"+x(c.parts[m][1]):x(c.parts[m]);return"["+(c.inverted?"^":"")+h+"]"},any:function(c){return"any character"},end:function(c){return"end of input"},other:function(c){return c.description}};function f(c){return c.charCodeAt(0).toString(16).toUpperCase()}function g(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(h){return"\\x0"+f(h)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(h){return"\\x"+f(h)})}function x(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(h){return"\\x0"+f(h)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(h){return"\\x"+f(h)})}function C(c){return e[c.type](c)}function l(c){var h=new Array(c.length),m,v;for(m=0;m<c.length;m++)h[m]=C(c[m]);if(h.sort(),h.length>0){for(m=1,v=1;m<h.length;m++)h[m-1]!==h[m]&&(h[v]=h[m],v++);h.length=v}switch(h.length){case 1:return h[0];case 2:return h[0]+" or "+h[1];default:return h.slice(0,-1).join(", ")+", or "+h[h.length-1]}}function p(c){return c?'"'+g(c)+'"':"end of input"}return"Expected "+l(o)+" but "+p(a)+" found."};function Gr(o,a){a=a!==void 0?a:{};var e={},f={svg_path:Ze},g=Ze,x=function(r){if(!r)return[];for(var t=[],n=0;n<r.length;n++)t=t.concat.apply(t,r[n]);var s=t[0];return s&&s.code=="m"&&(delete s.relative,s.code="M"),t},C=function(r,t){return Qr(r,t)},l=/^[Mm]/,p=V(["M","m"],!1,!1),c=function(r,t,n){var s=le(r,[t]);return n&&(s=s.concat(le(r=="M"?"L":"l",n[1]))),s},h=/^[Zz]/,m=V(["Z","z"],!1,!1),v=function(){return le("Z")},y=/^[Ll]/,O=V(["L","l"],!1,!1),_=function(r,t){return le(r,t)},I=/^[Hh]/,R=V(["H","h"],!1,!1),P=function(r,t){return le(r,t.map(function(n){return{x:n}}))},S=/^[Vv]/,N=V(["V","v"],!1,!1),X=function(r,t){return le(r,t.map(function(n){return{y:n}}))},b=/^[Cc]/,M=V(["C","c"],!1,!1),H=function(r,t,n){return{x1:r.x,y1:r.y,x2:t.x,y2:t.y,x:n.x,y:n.y}},F=/^[Ss]/,G=V(["S","s"],!1,!1),Y=function(r,t){return{x2:r.x,y2:r.y,x:t.x,y:t.y}},Q=/^[Qq]/,K=V(["Q","q"],!1,!1),J=function(r,t){return{x1:r.x,y1:r.y,x:t.x,y:t.y}},B=/^[Tt]/,Z=V(["T","t"],!1,!1),z=/^[Aa]/,j=V(["A","a"],!1,!1),$=function(r,t,n,s,u,d){return{rx:r,ry:t,xAxisRotation:n,largeArc:s,sweep:u,x:d.x,y:d.y}},w=function(r,t){return{x:r,y:t}},q=function(r){return r*1},te=function(r){return r.join("")*1},ae=/^[01]/,me=V(["0","1"],!1,!1),Ae=function(r){return r=="1"},ve=function(){return""},vr=",",gr=Be(",",!1),Me=function(r){return r.join("")},Pe=".",Xe=Be(".",!1),yr=/^[eE]/,dr=V(["e","E"],!1,!1),Tr=/^[+\-]/,xr=V(["+","-"],!1,!1),Ye=/^[0-9]/,Qe=V([["0","9"]],!1,!1),_r=function(r){return r.join("")},Cr=/^[ \t\n\r]/,Or=V([" ","	",`
`,"\r"],!1,!1),i=0,ge=[{line:1,column:1}],ee=0,Ne=[],ye;if("startRule"in a){if(!(a.startRule in f))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');g=f[a.startRule]}function Be(r,t){return{type:"literal",text:r,ignoreCase:t}}function V(r,t,n){return{type:"class",parts:r,inverted:t,ignoreCase:n}}function Ar(){return{type:"end"}}function ze(r){var t=ge[r],n;if(t)return t;for(n=r-1;!ge[n];)n--;for(t=ge[n],t={line:t.line,column:t.column};n<r;)o.charCodeAt(n)===10?(t.line++,t.column=1):t.column++,n++;return ge[r]=t,t}function qe(r,t){var n=ze(r),s=ze(t);return{start:{offset:r,line:n.line,column:n.column},end:{offset:t,line:s.line,column:s.column}}}function U(r){i<ee||(i>ee&&(ee=i,Ne=[]),Ne.push(r))}function Mr(r,t,n){return new ce(ce.buildMessage(r,t),r,t,n)}function Ze(){var r,t,n,s,u;for(r=i,t=[],n=A();n!==e;)t.push(n),n=A();if(t!==e)if(n=Nr(),n===e&&(n=null),n!==e){for(s=[],u=A();u!==e;)s.push(u),u=A();s!==e?(t=x(n),r=t):(i=r,r=e)}else i=r,r=e;else i=r,r=e;return r}function Nr(){var r,t,n,s,u,d;if(r=i,t=Ee(),t!==e){for(n=[],s=i,u=[],d=A();d!==e;)u.push(d),d=A();for(u!==e?(d=Ee(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);s!==e;){for(n.push(s),s=i,u=[],d=A();d!==e;)u.push(d),d=A();u!==e?(d=Ee(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e)}n!==e?(t=C(t,n),r=t):(i=r,r=e)}else i=r,r=e;return r}function Ee(){var r,t,n,s,u,d;if(r=i,t=Er(),t!==e){for(n=[],s=i,u=[],d=A();d!==e;)u.push(d),d=A();for(u!==e?(d=je(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);s!==e;){for(n.push(s),s=i,u=[],d=A();d!==e;)u.push(d),d=A();u!==e?(d=je(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e)}n!==e?(t=C(t,n),r=t):(i=r,r=e)}else i=r,r=e;return r}function je(){var r;return r=br(),r===e&&(r=Sr(),r===e&&(r=Rr(),r===e&&(r=wr(),r===e&&(r=$r(),r===e&&(r=Dr(),r===e&&(r=Hr(),r===e&&(r=Lr(),r===e&&(r=Pr())))))))),r}function Er(){var r,t,n,s,u,d,ue;if(r=i,l.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(p)),t!==e){for(n=[],s=A();s!==e;)n.push(s),s=A();n!==e?(s=L(),s!==e?(u=i,d=E(),d===e&&(d=null),d!==e?(ue=ke(),ue!==e?(d=[d,ue],u=d):(i=u,u=e)):(i=u,u=e),u===e&&(u=null),u!==e?(t=c(t,s,u),r=t):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)}else i=r,r=e;return r}function br(){var r,t;return r=i,h.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(m)),t!==e&&(t=v()),r=t,r}function Sr(){var r,t,n,s;if(r=i,y.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(O)),t!==e){for(n=[],s=A();s!==e;)n.push(s),s=A();n!==e?(s=ke(),s!==e?(t=_(t,s),r=t):(i=r,r=e)):(i=r,r=e)}else i=r,r=e;return r}function ke(){var r,t,n,s,u,d;if(r=i,t=L(),t!==e){for(n=[],s=i,u=E(),u===e&&(u=null),u!==e?(d=L(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);s!==e;)n.push(s),s=i,u=E(),u===e&&(u=null),u!==e?(d=L(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);n!==e?(t=C(t,n),r=t):(i=r,r=e)}else i=r,r=e;return r}function Rr(){var r,t,n,s;if(r=i,I.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(R)),t!==e){for(n=[],s=A();s!==e;)n.push(s),s=A();n!==e?(s=We(),s!==e?(t=P(t,s),r=t):(i=r,r=e)):(i=r,r=e)}else i=r,r=e;return r}function We(){var r,t,n,s,u,d;if(r=i,t=oe(),t!==e){for(n=[],s=i,u=E(),u===e&&(u=null),u!==e?(d=oe(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);s!==e;)n.push(s),s=i,u=E(),u===e&&(u=null),u!==e?(d=oe(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);n!==e?(t=C(t,n),r=t):(i=r,r=e)}else i=r,r=e;return r}function wr(){var r,t,n,s;if(r=i,S.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(N)),t!==e){for(n=[],s=A();s!==e;)n.push(s),s=A();n!==e?(s=We(),s!==e?(t=X(t,s),r=t):(i=r,r=e)):(i=r,r=e)}else i=r,r=e;return r}function $r(){var r,t,n,s;if(r=i,b.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(M)),t!==e){for(n=[],s=A();s!==e;)n.push(s),s=A();n!==e?(s=Ur(),s!==e?(t=_(t,s),r=t):(i=r,r=e)):(i=r,r=e)}else i=r,r=e;return r}function Ur(){var r,t,n,s,u,d;if(r=i,t=be(),t!==e){for(n=[],s=i,u=E(),u===e&&(u=null),u!==e?(d=be(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);s!==e;)n.push(s),s=i,u=E(),u===e&&(u=null),u!==e?(d=be(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);n!==e?(t=C(t,n),r=t):(i=r,r=e)}else i=r,r=e;return r}function be(){var r,t,n,s,u,d;return r=i,t=L(),t!==e?(n=E(),n===e&&(n=null),n!==e?(s=L(),s!==e?(u=E(),u===e&&(u=null),u!==e?(d=L(),d!==e?(t=H(t,s,d),r=t):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)):(i=r,r=e),r}function Dr(){var r,t,n,s;if(r=i,F.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(G)),t!==e){for(n=[],s=A();s!==e;)n.push(s),s=A();n!==e?(s=Ir(),s!==e?(t=_(t,s),r=t):(i=r,r=e)):(i=r,r=e)}else i=r,r=e;return r}function Ir(){var r,t,n,s,u,d;if(r=i,t=Se(),t!==e){for(n=[],s=i,u=E(),u===e&&(u=null),u!==e?(d=Se(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);s!==e;)n.push(s),s=i,u=E(),u===e&&(u=null),u!==e?(d=Se(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);n!==e?(t=C(t,n),r=t):(i=r,r=e)}else i=r,r=e;return r}function Se(){var r,t,n,s;return r=i,t=L(),t!==e?(n=E(),n===e&&(n=null),n!==e?(s=L(),s!==e?(t=Y(t,s),r=t):(i=r,r=e)):(i=r,r=e)):(i=r,r=e),r}function Hr(){var r,t,n,s;if(r=i,Q.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(K)),t!==e){for(n=[],s=A();s!==e;)n.push(s),s=A();n!==e?(s=Vr(),s!==e?(t=_(t,s),r=t):(i=r,r=e)):(i=r,r=e)}else i=r,r=e;return r}function Vr(){var r,t,n,s,u,d;if(r=i,t=Re(),t!==e){for(n=[],s=i,u=E(),u===e&&(u=null),u!==e?(d=Re(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);s!==e;)n.push(s),s=i,u=E(),u===e&&(u=null),u!==e?(d=Re(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);n!==e?(t=C(t,n),r=t):(i=r,r=e)}else i=r,r=e;return r}function Re(){var r,t,n,s;return r=i,t=L(),t!==e?(n=E(),n===e&&(n=null),n!==e?(s=L(),s!==e?(t=J(t,s),r=t):(i=r,r=e)):(i=r,r=e)):(i=r,r=e),r}function Lr(){var r,t,n,s;if(r=i,B.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(Z)),t!==e){for(n=[],s=A();s!==e;)n.push(s),s=A();n!==e?(s=Fr(),s!==e?(t=_(t,s),r=t):(i=r,r=e)):(i=r,r=e)}else i=r,r=e;return r}function Fr(){var r,t,n,s,u,d;if(r=i,t=L(),t!==e){for(n=[],s=i,u=E(),u===e&&(u=null),u!==e?(d=L(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);s!==e;)n.push(s),s=i,u=E(),u===e&&(u=null),u!==e?(d=L(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);n!==e?(t=C(t,n),r=t):(i=r,r=e)}else i=r,r=e;return r}function Pr(){var r,t,n,s;if(r=i,z.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(j)),t!==e){for(n=[],s=A();s!==e;)n.push(s),s=A();n!==e?(s=Xr(),s!==e?(t=_(t,s),r=t):(i=r,r=e)):(i=r,r=e)}else i=r,r=e;return r}function Xr(){var r,t,n,s,u,d;if(r=i,t=we(),t!==e){for(n=[],s=i,u=E(),u===e&&(u=null),u!==e?(d=we(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);s!==e;)n.push(s),s=i,u=E(),u===e&&(u=null),u!==e?(d=we(),d!==e?(u=[u,d],s=u):(i=s,s=e)):(i=s,s=e);n!==e?(t=C(t,n),r=t):(i=r,r=e)}else i=r,r=e;return r}function we(){var r,t,n,s,u,d,ue,Ue,Te,De,xe,Ie;return r=i,t=Ge(),t!==e?(n=E(),n===e&&(n=null),n!==e?(s=Ge(),s!==e?(u=E(),u===e&&(u=null),u!==e?(d=oe(),d!==e?(ue=E(),ue!==e?(Ue=Ke(),Ue!==e?(Te=E(),Te===e&&(Te=null),Te!==e?(De=Ke(),De!==e?(xe=E(),xe===e&&(xe=null),xe!==e?(Ie=L(),Ie!==e?(t=$(t,s,d,Ue,De,Ie),r=t):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)):(i=r,r=e)):(i=r,r=e),r}function L(){var r,t,n,s;return r=i,t=oe(),t!==e?(n=E(),n===e&&(n=null),n!==e?(s=oe(),s!==e?(t=w(t,s),r=t):(i=r,r=e)):(i=r,r=e)):(i=r,r=e),r}function Ge(){var r,t;return r=i,t=er(),t===e&&(t=ne()),t!==e&&(t=q(t)),r=t,r}function oe(){var r,t,n,s;return r=i,t=i,n=$e(),n===e&&(n=null),n!==e?(s=er(),s!==e?(n=[n,s],t=n):(i=t,t=e)):(i=t,t=e),t===e&&(t=i,n=$e(),n===e&&(n=null),n!==e?(s=ne(),s!==e?(n=[n,s],t=n):(i=t,t=e)):(i=t,t=e)),t!==e&&(t=te(t)),r=t,r}function Ke(){var r,t;return r=i,ae.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(me)),t!==e&&(t=Ae(t)),r=t,r}function E(){var r,t,n,s,u;if(r=i,t=[],n=A(),n!==e)for(;n!==e;)t.push(n),n=A();else t=e;if(t!==e)if(n=Je(),n===e&&(n=null),n!==e){for(s=[],u=A();u!==e;)s.push(u),u=A();s!==e?(t=[t,n,s],r=t):(i=r,r=e)}else i=r,r=e;else i=r,r=e;if(r===e){if(r=i,t=i,n=Je(),n!==e){for(s=[],u=A();u!==e;)s.push(u),u=A();s!==e?(n=[n,s],t=n):(i=t,t=e)}else i=t,t=e;t!==e&&(t=ve()),r=t}return r}function Je(){var r;return o.charCodeAt(i)===44?(r=vr,i++):(r=e,U(gr)),r}function er(){var r,t,n,s;return r=i,t=i,n=Yr(),n!==e?(s=rr(),s===e&&(s=null),s!==e?(n=[n,s],t=n):(i=t,t=e)):(i=t,t=e),t===e&&(t=i,n=ne(),n!==e?(s=rr(),s!==e?(n=[n,s],t=n):(i=t,t=e)):(i=t,t=e)),t!==e&&(t=Me(t)),r=t,r}function Yr(){var r,t,n,s,u;return r=i,t=i,n=ne(),n===e&&(n=null),n!==e?(o.charCodeAt(i)===46?(s=Pe,i++):(s=e,U(Xe)),s!==e?(u=ne(),u!==e?(n=[n,s,u],t=n):(i=t,t=e)):(i=t,t=e)):(i=t,t=e),t===e&&(t=i,n=ne(),n!==e?(o.charCodeAt(i)===46?(s=Pe,i++):(s=e,U(Xe)),s!==e?(n=[n,s],t=n):(i=t,t=e)):(i=t,t=e)),t!==e&&(t=Me(t)),r=t,r}function rr(){var r,t,n,s,u;return r=i,t=i,yr.test(o.charAt(i))?(n=o.charAt(i),i++):(n=e,U(dr)),n!==e?(s=$e(),s===e&&(s=null),s!==e?(u=ne(),u!==e?(n=[n,s,u],t=n):(i=t,t=e)):(i=t,t=e)):(i=t,t=e),t!==e&&(t=Me(t)),r=t,r}function $e(){var r;return Tr.test(o.charAt(i))?(r=o.charAt(i),i++):(r=e,U(xr)),r}function ne(){var r,t,n;if(r=i,t=[],Ye.test(o.charAt(i))?(n=o.charAt(i),i++):(n=e,U(Qe)),n!==e)for(;n!==e;)t.push(n),Ye.test(o.charAt(i))?(n=o.charAt(i),i++):(n=e,U(Qe));else t=e;return t!==e&&(t=_r(t)),r=t,r}function A(){var r,t;return r=i,Cr.test(o.charAt(i))?(t=o.charAt(i),i++):(t=e,U(Or)),t!==e&&(t=ve()),r=t,r}function Qr(r,t){if(!t)return[r];for(var n=[r],s=0,u=t.length;s<u;s++)n[s+1]=t[s][1];return n}var de={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var tr in de)de[tr.toUpperCase()]=de[tr];function le(r,t){t||(t=[{}]);for(var n=t.length;n--;){var s={code:r,command:de[r]};r==r.toLowerCase()&&(s.relative=!0);for(var u in t[n])s[u]=t[n][u];t[n]=s}return t}if(ye=g(),ye!==e&&i===o.length)return ye;throw ye!==e&&i<o.length&&U(Ar()),Mr(Ne,ee<o.length?o.charAt(ee):null,ee<o.length?qe(ee,ee+1):qe(ee,ee))}var Kr={SyntaxError:ce,parse:Gr},Oe=Kr.parse;Oe.parseSVG=Oe;Oe.makeAbsolute=Jr;var fr=Oe;function Jr(o){var a,e={x:0,y:0},f={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return o.forEach(function(g){g.command==="moveto"&&(a=g),g.x0=e.x,g.y0=e.y;for(var x in f)x in g&&(g[x]+=g.relative?g[f[x]]:0);"x"in g||(g.x=e.x),"y"in g||(g.y=e.y),g.relative=!1,g.code=g.code.toUpperCase(),g.command=="closepath"&&(g.x=a.x,g.y=a.y),e=g}),o}const et=Br(fr),ut=kr({__proto__:null,default:et},[fr]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var hr=function(o,a){return(hr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,f){e.__proto__=f}||function(e,f){for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&(e[g]=f[g])})(o,a)};function pr(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function e(){this.constructor=o}hr(o,a),o.prototype=a===null?Object.create(a):(e.prototype=a.prototype,new e)}function rt(o){var a="";Array.isArray(o)||(o=[o]);for(var e=0;e<o.length;e++){var f=o[e];if(f.type===T.CLOSE_PATH)a+="z";else if(f.type===T.HORIZ_LINE_TO)a+=(f.relative?"h":"H")+f.x;else if(f.type===T.VERT_LINE_TO)a+=(f.relative?"v":"V")+f.y;else if(f.type===T.MOVE_TO)a+=(f.relative?"m":"M")+f.x+" "+f.y;else if(f.type===T.LINE_TO)a+=(f.relative?"l":"L")+f.x+" "+f.y;else if(f.type===T.CURVE_TO)a+=(f.relative?"c":"C")+f.x1+" "+f.y1+" "+f.x2+" "+f.y2+" "+f.x+" "+f.y;else if(f.type===T.SMOOTH_CURVE_TO)a+=(f.relative?"s":"S")+f.x2+" "+f.y2+" "+f.x+" "+f.y;else if(f.type===T.QUAD_TO)a+=(f.relative?"q":"Q")+f.x1+" "+f.y1+" "+f.x+" "+f.y;else if(f.type===T.SMOOTH_QUAD_TO)a+=(f.relative?"t":"T")+f.x+" "+f.y;else{if(f.type!==T.ARC)throw new Error('Unexpected command type "'+f.type+'" at index '+e+".");a+=(f.relative?"a":"A")+f.rX+" "+f.rY+" "+f.xRot+" "+ +f.lArcFlag+" "+ +f.sweepFlag+" "+f.x+" "+f.y}}return a}function Fe(o,a){var e=o[0],f=o[1];return[e*Math.cos(a)-f*Math.sin(a),e*Math.sin(a)+f*Math.cos(a)]}function W(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];for(var e=0;e<o.length;e++)if(typeof o[e]!="number")throw new Error("assertNumbers arguments["+e+"] is not a number. "+typeof o[e]+" == typeof "+o[e]);return!0}var ie=Math.PI;function Le(o,a,e){o.lArcFlag=o.lArcFlag===0?0:1,o.sweepFlag=o.sweepFlag===0?0:1;var f=o.rX,g=o.rY,x=o.x,C=o.y;f=Math.abs(o.rX),g=Math.abs(o.rY);var l=Fe([(a-x)/2,(e-C)/2],-o.xRot/180*ie),p=l[0],c=l[1],h=Math.pow(p,2)/Math.pow(f,2)+Math.pow(c,2)/Math.pow(g,2);1<h&&(f*=Math.sqrt(h),g*=Math.sqrt(h)),o.rX=f,o.rY=g;var m=Math.pow(f,2)*Math.pow(c,2)+Math.pow(g,2)*Math.pow(p,2),v=(o.lArcFlag!==o.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(f,2)*Math.pow(g,2)-m)/m)),y=f*c/g*v,O=-g*p/f*v,_=Fe([y,O],o.xRot/180*ie);o.cX=_[0]+(a+x)/2,o.cY=_[1]+(e+C)/2,o.phi1=Math.atan2((c-O)/g,(p-y)/f),o.phi2=Math.atan2((-c-O)/g,(-p-y)/f),o.sweepFlag===0&&o.phi2>o.phi1&&(o.phi2-=2*ie),o.sweepFlag===1&&o.phi2<o.phi1&&(o.phi2+=2*ie),o.phi1*=180/ie,o.phi2*=180/ie}function ir(o,a,e){W(o,a,e);var f=o*o+a*a-e*e;if(0>f)return[];if(f===0)return[[o*e/(o*o+a*a),a*e/(o*o+a*a)]];var g=Math.sqrt(f);return[[(o*e+a*g)/(o*o+a*a),(a*e-o*g)/(o*o+a*a)],[(o*e-a*g)/(o*o+a*a),(a*e+o*g)/(o*o+a*a)]]}var D,re=Math.PI/180;function ar(o,a,e){return(1-e)*o+e*a}function nr(o,a,e,f){return o+Math.cos(f/180*ie)*a+Math.sin(f/180*ie)*e}function or(o,a,e,f){var g=1e-6,x=a-o,C=e-a,l=3*x+3*(f-e)-6*C,p=6*(C-x),c=3*x;return Math.abs(l)<g?[-c/p]:function(h,m,v){var y=h*h/4-m;if(y<-v)return[];if(y<=v)return[-h/2];var O=Math.sqrt(y);return[-h/2-O,-h/2+O]}(p/l,c/l,g)}function lr(o,a,e,f,g){var x=1-g;return o*(x*x*x)+a*(3*x*x*g)+e*(3*x*g*g)+f*(g*g*g)}(function(o){function a(){return g(function(l,p,c){return l.relative&&(l.x1!==void 0&&(l.x1+=p),l.y1!==void 0&&(l.y1+=c),l.x2!==void 0&&(l.x2+=p),l.y2!==void 0&&(l.y2+=c),l.x!==void 0&&(l.x+=p),l.y!==void 0&&(l.y+=c),l.relative=!1),l})}function e(){var l=NaN,p=NaN,c=NaN,h=NaN;return g(function(m,v,y){return m.type&T.SMOOTH_CURVE_TO&&(m.type=T.CURVE_TO,l=isNaN(l)?v:l,p=isNaN(p)?y:p,m.x1=m.relative?v-l:2*v-l,m.y1=m.relative?y-p:2*y-p),m.type&T.CURVE_TO?(l=m.relative?v+m.x2:m.x2,p=m.relative?y+m.y2:m.y2):(l=NaN,p=NaN),m.type&T.SMOOTH_QUAD_TO&&(m.type=T.QUAD_TO,c=isNaN(c)?v:c,h=isNaN(h)?y:h,m.x1=m.relative?v-c:2*v-c,m.y1=m.relative?y-h:2*y-h),m.type&T.QUAD_TO?(c=m.relative?v+m.x1:m.x1,h=m.relative?y+m.y1:m.y1):(c=NaN,h=NaN),m})}function f(){var l=NaN,p=NaN;return g(function(c,h,m){if(c.type&T.SMOOTH_QUAD_TO&&(c.type=T.QUAD_TO,l=isNaN(l)?h:l,p=isNaN(p)?m:p,c.x1=c.relative?h-l:2*h-l,c.y1=c.relative?m-p:2*m-p),c.type&T.QUAD_TO){l=c.relative?h+c.x1:c.x1,p=c.relative?m+c.y1:c.y1;var v=c.x1,y=c.y1;c.type=T.CURVE_TO,c.x1=((c.relative?0:h)+2*v)/3,c.y1=((c.relative?0:m)+2*y)/3,c.x2=(c.x+2*v)/3,c.y2=(c.y+2*y)/3}else l=NaN,p=NaN;return c})}function g(l){var p=0,c=0,h=NaN,m=NaN;return function(v){if(isNaN(h)&&!(v.type&T.MOVE_TO))throw new Error("path must start with moveto");var y=l(v,p,c,h,m);return v.type&T.CLOSE_PATH&&(p=h,c=m),v.x!==void 0&&(p=v.relative?p+v.x:v.x),v.y!==void 0&&(c=v.relative?c+v.y:v.y),v.type&T.MOVE_TO&&(h=p,m=c),y}}function x(l,p,c,h,m,v){return W(l,p,c,h,m,v),g(function(y,O,_,I){var R=y.x1,P=y.x2,S=y.relative&&!isNaN(I),N=y.x!==void 0?y.x:S?0:O,X=y.y!==void 0?y.y:S?0:_;function b(te){return te*te}y.type&T.HORIZ_LINE_TO&&p!==0&&(y.type=T.LINE_TO,y.y=y.relative?0:_),y.type&T.VERT_LINE_TO&&c!==0&&(y.type=T.LINE_TO,y.x=y.relative?0:O),y.x!==void 0&&(y.x=y.x*l+X*c+(S?0:m)),y.y!==void 0&&(y.y=N*p+y.y*h+(S?0:v)),y.x1!==void 0&&(y.x1=y.x1*l+y.y1*c+(S?0:m)),y.y1!==void 0&&(y.y1=R*p+y.y1*h+(S?0:v)),y.x2!==void 0&&(y.x2=y.x2*l+y.y2*c+(S?0:m)),y.y2!==void 0&&(y.y2=P*p+y.y2*h+(S?0:v));var M=l*h-p*c;if(y.xRot!==void 0&&(l!==1||p!==0||c!==0||h!==1))if(M===0)delete y.rX,delete y.rY,delete y.xRot,delete y.lArcFlag,delete y.sweepFlag,y.type=T.LINE_TO;else{var H=y.xRot*Math.PI/180,F=Math.sin(H),G=Math.cos(H),Y=1/b(y.rX),Q=1/b(y.rY),K=b(G)*Y+b(F)*Q,J=2*F*G*(Y-Q),B=b(F)*Y+b(G)*Q,Z=K*h*h-J*p*h+B*p*p,z=J*(l*h+p*c)-2*(K*c*h+B*l*p),j=K*c*c-J*l*c+B*l*l,$=(Math.atan2(z,Z-j)+Math.PI)%Math.PI/2,w=Math.sin($),q=Math.cos($);y.rX=Math.abs(M)/Math.sqrt(Z*b(q)+z*w*q+j*b(w)),y.rY=Math.abs(M)/Math.sqrt(Z*b(w)-z*w*q+j*b(q)),y.xRot=180*$/Math.PI}return y.sweepFlag!==void 0&&0>M&&(y.sweepFlag=+!y.sweepFlag),y})}function C(){return function(l){var p={};for(var c in l)p[c]=l[c];return p}}o.ROUND=function(l){function p(c){return Math.round(c*l)/l}return l===void 0&&(l=1e13),W(l),function(c){return c.x1!==void 0&&(c.x1=p(c.x1)),c.y1!==void 0&&(c.y1=p(c.y1)),c.x2!==void 0&&(c.x2=p(c.x2)),c.y2!==void 0&&(c.y2=p(c.y2)),c.x!==void 0&&(c.x=p(c.x)),c.y!==void 0&&(c.y=p(c.y)),c.rX!==void 0&&(c.rX=p(c.rX)),c.rY!==void 0&&(c.rY=p(c.rY)),c}},o.TO_ABS=a,o.TO_REL=function(){return g(function(l,p,c){return l.relative||(l.x1!==void 0&&(l.x1-=p),l.y1!==void 0&&(l.y1-=c),l.x2!==void 0&&(l.x2-=p),l.y2!==void 0&&(l.y2-=c),l.x!==void 0&&(l.x-=p),l.y!==void 0&&(l.y-=c),l.relative=!0),l})},o.NORMALIZE_HVZ=function(l,p,c){return l===void 0&&(l=!0),p===void 0&&(p=!0),c===void 0&&(c=!0),g(function(h,m,v,y,O){if(isNaN(y)&&!(h.type&T.MOVE_TO))throw new Error("path must start with moveto");return p&&h.type&T.HORIZ_LINE_TO&&(h.type=T.LINE_TO,h.y=h.relative?0:v),c&&h.type&T.VERT_LINE_TO&&(h.type=T.LINE_TO,h.x=h.relative?0:m),l&&h.type&T.CLOSE_PATH&&(h.type=T.LINE_TO,h.x=h.relative?y-m:y,h.y=h.relative?O-v:O),h.type&T.ARC&&(h.rX===0||h.rY===0)&&(h.type=T.LINE_TO,delete h.rX,delete h.rY,delete h.xRot,delete h.lArcFlag,delete h.sweepFlag),h})},o.NORMALIZE_ST=e,o.QT_TO_C=f,o.INFO=g,o.SANITIZE=function(l){l===void 0&&(l=0),W(l);var p=NaN,c=NaN,h=NaN,m=NaN;return g(function(v,y,O,_,I){var R=Math.abs,P=!1,S=0,N=0;if(v.type&T.SMOOTH_CURVE_TO&&(S=isNaN(p)?0:y-p,N=isNaN(c)?0:O-c),v.type&(T.CURVE_TO|T.SMOOTH_CURVE_TO)?(p=v.relative?y+v.x2:v.x2,c=v.relative?O+v.y2:v.y2):(p=NaN,c=NaN),v.type&T.SMOOTH_QUAD_TO?(h=isNaN(h)?y:2*y-h,m=isNaN(m)?O:2*O-m):v.type&T.QUAD_TO?(h=v.relative?y+v.x1:v.x1,m=v.relative?O+v.y1:v.y2):(h=NaN,m=NaN),v.type&T.LINE_COMMANDS||v.type&T.ARC&&(v.rX===0||v.rY===0||!v.lArcFlag)||v.type&T.CURVE_TO||v.type&T.SMOOTH_CURVE_TO||v.type&T.QUAD_TO||v.type&T.SMOOTH_QUAD_TO){var X=v.x===void 0?0:v.relative?v.x:v.x-y,b=v.y===void 0?0:v.relative?v.y:v.y-O;S=isNaN(h)?v.x1===void 0?S:v.relative?v.x:v.x1-y:h-y,N=isNaN(m)?v.y1===void 0?N:v.relative?v.y:v.y1-O:m-O;var M=v.x2===void 0?0:v.relative?v.x:v.x2-y,H=v.y2===void 0?0:v.relative?v.y:v.y2-O;R(X)<=l&&R(b)<=l&&R(S)<=l&&R(N)<=l&&R(M)<=l&&R(H)<=l&&(P=!0)}return v.type&T.CLOSE_PATH&&R(y-_)<=l&&R(O-I)<=l&&(P=!0),P?[]:v})},o.MATRIX=x,o.ROTATE=function(l,p,c){p===void 0&&(p=0),c===void 0&&(c=0),W(l,p,c);var h=Math.sin(l),m=Math.cos(l);return x(m,h,-h,m,p-p*m+c*h,c-p*h-c*m)},o.TRANSLATE=function(l,p){return p===void 0&&(p=0),W(l,p),x(1,0,0,1,l,p)},o.SCALE=function(l,p){return p===void 0&&(p=l),W(l,p),x(l,0,0,p,0,0)},o.SKEW_X=function(l){return W(l),x(1,0,Math.atan(l),1,0,0)},o.SKEW_Y=function(l){return W(l),x(1,Math.atan(l),0,1,0,0)},o.X_AXIS_SYMMETRY=function(l){return l===void 0&&(l=0),W(l),x(-1,0,0,1,l,0)},o.Y_AXIS_SYMMETRY=function(l){return l===void 0&&(l=0),W(l),x(1,0,0,-1,0,l)},o.A_TO_C=function(){return g(function(l,p,c){return T.ARC===l.type?function(h,m,v){var y,O,_,I;h.cX||Le(h,m,v);for(var R=Math.min(h.phi1,h.phi2),P=Math.max(h.phi1,h.phi2)-R,S=Math.ceil(P/90),N=new Array(S),X=m,b=v,M=0;M<S;M++){var H=ar(h.phi1,h.phi2,M/S),F=ar(h.phi1,h.phi2,(M+1)/S),G=F-H,Y=4/3*Math.tan(G*re/4),Q=[Math.cos(H*re)-Y*Math.sin(H*re),Math.sin(H*re)+Y*Math.cos(H*re)],K=Q[0],J=Q[1],B=[Math.cos(F*re),Math.sin(F*re)],Z=B[0],z=B[1],j=[Z+Y*Math.sin(F*re),z-Y*Math.cos(F*re)],$=j[0],w=j[1];N[M]={relative:h.relative,type:T.CURVE_TO};var q=function(te,ae){var me=Fe([te*h.rX,ae*h.rY],h.xRot),Ae=me[0],ve=me[1];return[h.cX+Ae,h.cY+ve]};y=q(K,J),N[M].x1=y[0],N[M].y1=y[1],O=q($,w),N[M].x2=O[0],N[M].y2=O[1],_=q(Z,z),N[M].x=_[0],N[M].y=_[1],h.relative&&(N[M].x1-=X,N[M].y1-=b,N[M].x2-=X,N[M].y2-=b,N[M].x-=X,N[M].y-=b),X=(I=[N[M].x,N[M].y])[0],b=I[1]}return N}(l,l.relative?0:p,l.relative?0:c):l})},o.ANNOTATE_ARCS=function(){return g(function(l,p,c){return l.relative&&(p=0,c=0),T.ARC===l.type&&Le(l,p,c),l})},o.CLONE=C,o.CALCULATE_BOUNDS=function(){var l=function(v){var y={};for(var O in v)y[O]=v[O];return y},p=a(),c=f(),h=e(),m=g(function(v,y,O){var _=h(c(p(l(v))));function I(w){w>m.maxX&&(m.maxX=w),w<m.minX&&(m.minX=w)}function R(w){w>m.maxY&&(m.maxY=w),w<m.minY&&(m.minY=w)}if(_.type&T.DRAWING_COMMANDS&&(I(y),R(O)),_.type&T.HORIZ_LINE_TO&&I(_.x),_.type&T.VERT_LINE_TO&&R(_.y),_.type&T.LINE_TO&&(I(_.x),R(_.y)),_.type&T.CURVE_TO){I(_.x),R(_.y);for(var P=0,S=or(y,_.x1,_.x2,_.x);P<S.length;P++)0<($=S[P])&&1>$&&I(lr(y,_.x1,_.x2,_.x,$));for(var N=0,X=or(O,_.y1,_.y2,_.y);N<X.length;N++)0<($=X[N])&&1>$&&R(lr(O,_.y1,_.y2,_.y,$))}if(_.type&T.ARC){I(_.x),R(_.y),Le(_,y,O);for(var b=_.xRot/180*Math.PI,M=Math.cos(b)*_.rX,H=Math.sin(b)*_.rX,F=-Math.sin(b)*_.rY,G=Math.cos(b)*_.rY,Y=_.phi1<_.phi2?[_.phi1,_.phi2]:-180>_.phi2?[_.phi2+360,_.phi1+360]:[_.phi2,_.phi1],Q=Y[0],K=Y[1],J=function(w){var q=w[0],te=w[1],ae=180*Math.atan2(te,q)/Math.PI;return ae<Q?ae+360:ae},B=0,Z=ir(F,-M,0).map(J);B<Z.length;B++)($=Z[B])>Q&&$<K&&I(nr(_.cX,M,F,$));for(var z=0,j=ir(G,-H,0).map(J);z<j.length;z++){var $;($=j[z])>Q&&$<K&&R(nr(_.cY,H,G,$))}}return v});return m.minX=1/0,m.maxX=-1/0,m.minY=1/0,m.maxY=-1/0,m}})(D||(D={}));var k,mr=function(){function o(){}return o.prototype.round=function(a){return this.transform(D.ROUND(a))},o.prototype.toAbs=function(){return this.transform(D.TO_ABS())},o.prototype.toRel=function(){return this.transform(D.TO_REL())},o.prototype.normalizeHVZ=function(a,e,f){return this.transform(D.NORMALIZE_HVZ(a,e,f))},o.prototype.normalizeST=function(){return this.transform(D.NORMALIZE_ST())},o.prototype.qtToC=function(){return this.transform(D.QT_TO_C())},o.prototype.aToC=function(){return this.transform(D.A_TO_C())},o.prototype.sanitize=function(a){return this.transform(D.SANITIZE(a))},o.prototype.translate=function(a,e){return this.transform(D.TRANSLATE(a,e))},o.prototype.scale=function(a,e){return this.transform(D.SCALE(a,e))},o.prototype.rotate=function(a,e,f){return this.transform(D.ROTATE(a,e,f))},o.prototype.matrix=function(a,e,f,g,x,C){return this.transform(D.MATRIX(a,e,f,g,x,C))},o.prototype.skewX=function(a){return this.transform(D.SKEW_X(a))},o.prototype.skewY=function(a){return this.transform(D.SKEW_Y(a))},o.prototype.xSymmetry=function(a){return this.transform(D.X_AXIS_SYMMETRY(a))},o.prototype.ySymmetry=function(a){return this.transform(D.Y_AXIS_SYMMETRY(a))},o.prototype.annotateArcs=function(){return this.transform(D.ANNOTATE_ARCS())},o}(),tt=function(o){return o===" "||o==="	"||o==="\r"||o===`
`},ur=function(o){return 48<=o.charCodeAt(0)&&o.charCodeAt(0)<=57},st=function(o){function a(){var e=o.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return pr(a,o),a.prototype.finish=function(e){if(e===void 0&&(e=[]),this.parse(" ",e),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return e},a.prototype.parse=function(e,f){var g=this;f===void 0&&(f=[]);for(var x=function(m){f.push(m),g.curArgs.length=0,g.canParseCommandOrComma=!0},C=0;C<e.length;C++){var l=e[C],p=!(this.curCommandType!==T.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),c=ur(l)&&(this.curNumber==="0"&&l==="0"||p);if(!ur(l)||c)if(l!=="e"&&l!=="E")if(l!=="-"&&l!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(l!=="."||this.curNumberHasExp||this.curNumberHasDecimal||p){if(this.curNumber&&this.curCommandType!==-1){var h=Number(this.curNumber);if(isNaN(h))throw new SyntaxError("Invalid number ending at "+C);if(this.curCommandType===T.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>h)throw new SyntaxError('Expected positive number, got "'+h+'" at index "'+C+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+C+'"')}this.curArgs.push(h),this.curArgs.length===it[this.curCommandType]&&(T.HORIZ_LINE_TO===this.curCommandType?x({type:T.HORIZ_LINE_TO,relative:this.curCommandRelative,x:h}):T.VERT_LINE_TO===this.curCommandType?x({type:T.VERT_LINE_TO,relative:this.curCommandRelative,y:h}):this.curCommandType===T.MOVE_TO||this.curCommandType===T.LINE_TO||this.curCommandType===T.SMOOTH_QUAD_TO?(x({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),T.MOVE_TO===this.curCommandType&&(this.curCommandType=T.LINE_TO)):this.curCommandType===T.CURVE_TO?x({type:T.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===T.SMOOTH_CURVE_TO?x({type:T.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===T.QUAD_TO?x({type:T.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===T.ARC&&x({type:T.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!tt(l))if(l===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(l!=="+"&&l!=="-"&&l!==".")if(c)this.curNumber=l,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+C+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+l+'" at index '+C+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,l!=="z"&&l!=="Z")if(l==="h"||l==="H")this.curCommandType=T.HORIZ_LINE_TO,this.curCommandRelative=l==="h";else if(l==="v"||l==="V")this.curCommandType=T.VERT_LINE_TO,this.curCommandRelative=l==="v";else if(l==="m"||l==="M")this.curCommandType=T.MOVE_TO,this.curCommandRelative=l==="m";else if(l==="l"||l==="L")this.curCommandType=T.LINE_TO,this.curCommandRelative=l==="l";else if(l==="c"||l==="C")this.curCommandType=T.CURVE_TO,this.curCommandRelative=l==="c";else if(l==="s"||l==="S")this.curCommandType=T.SMOOTH_CURVE_TO,this.curCommandRelative=l==="s";else if(l==="q"||l==="Q")this.curCommandType=T.QUAD_TO,this.curCommandRelative=l==="q";else if(l==="t"||l==="T")this.curCommandType=T.SMOOTH_QUAD_TO,this.curCommandRelative=l==="t";else{if(l!=="a"&&l!=="A")throw new SyntaxError('Unexpected character "'+l+'" at index '+C+".");this.curCommandType=T.ARC,this.curCommandRelative=l==="a"}else f.push({type:T.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=l,this.curNumberHasDecimal=l==="."}else this.curNumber+=l,this.curNumberHasDecimal=!0;else this.curNumber+=l;else this.curNumber+=l,this.curNumberHasExp=!0;else this.curNumber+=l,this.curNumberHasExpDigits=this.curNumberHasExp}return f},a.prototype.transform=function(e){return Object.create(this,{parse:{value:function(f,g){g===void 0&&(g=[]);for(var x=0,C=Object.getPrototypeOf(this).parse.call(this,f);x<C.length;x++){var l=C[x],p=e(l);Array.isArray(p)?g.push.apply(g,p):g.push(p)}return g}}})},a}(mr),T=function(o){function a(e){var f=o.call(this)||this;return f.commands=typeof e=="string"?a.parse(e):e,f}return pr(a,o),a.prototype.encode=function(){return a.encode(this.commands)},a.prototype.getBounds=function(){var e=D.CALCULATE_BOUNDS();return this.transform(e),e},a.prototype.transform=function(e){for(var f=[],g=0,x=this.commands;g<x.length;g++){var C=e(x[g]);Array.isArray(C)?f.push.apply(f,C):f.push(C)}return this.commands=f,this},a.encode=function(e){return rt(e)},a.parse=function(e){var f=new st,g=[];return f.parse(e,g),f.finish(g),g},a.CLOSE_PATH=1,a.MOVE_TO=2,a.HORIZ_LINE_TO=4,a.VERT_LINE_TO=8,a.LINE_TO=16,a.CURVE_TO=32,a.SMOOTH_CURVE_TO=64,a.QUAD_TO=128,a.SMOOTH_QUAD_TO=256,a.ARC=512,a.LINE_COMMANDS=a.LINE_TO|a.HORIZ_LINE_TO|a.VERT_LINE_TO,a.DRAWING_COMMANDS=a.HORIZ_LINE_TO|a.VERT_LINE_TO|a.LINE_TO|a.CURVE_TO|a.SMOOTH_CURVE_TO|a.QUAD_TO|a.SMOOTH_QUAD_TO|a.ARC,a}(mr),it=((k={})[T.MOVE_TO]=2,k[T.LINE_TO]=2,k[T.HORIZ_LINE_TO]=1,k[T.VERT_LINE_TO]=1,k[T.CLOSE_PATH]=0,k[T.QUAD_TO]=4,k[T.SMOOTH_QUAD_TO]=2,k[T.CURVE_TO]=6,k[T.SMOOTH_CURVE_TO]=4,k[T.ARC]=7,k);const at={name:"LuminosityHighPassShader",shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Ce(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class pe extends cr{constructor(a,e,f,g){super(),this.strength=e!==void 0?e:1,this.radius=f,this.threshold=g,this.resolution=a!==void 0?new se(a.x,a.y):new se(256,256),this.clearColor=new Ce(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let x=Math.round(this.resolution.x/2),C=Math.round(this.resolution.y/2);this.renderTargetBright=new He(x,C,{type:Ve}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let m=0;m<this.nMips;m++){const v=new He(x,C,{type:Ve});v.texture.name="UnrealBloomPass.h"+m,v.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(v);const y=new He(x,C,{type:Ve});y.texture.name="UnrealBloomPass.v"+m,y.texture.generateMipmaps=!1,this.renderTargetsVertical.push(y),x=Math.round(x/2),C=Math.round(C/2)}const l=at;this.highPassUniforms=sr.clone(l.uniforms),this.highPassUniforms.luminosityThreshold.value=g,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new _e({uniforms:this.highPassUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}),this.separableBlurMaterials=[];const p=[3,5,7,9,11];x=Math.round(this.resolution.x/2),C=Math.round(this.resolution.y/2);for(let m=0;m<this.nMips;m++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(p[m])),this.separableBlurMaterials[m].uniforms.invSize.value=new se(1/x,1/C),x=Math.round(x/2),C=Math.round(C/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=e,this.compositeMaterial.uniforms.bloomRadius.value=.1;const c=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=c,this.bloomTintColors=[new fe(1,1,1),new fe(1,1,1),new fe(1,1,1),new fe(1,1,1),new fe(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const h=jr;this.copyUniforms=sr.clone(h.uniforms),this.blendMaterial=new _e({uniforms:this.copyUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:zr,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Ce,this.oldClearAlpha=1,this.basic=new qr,this.fsQuad=new Zr(null)}dispose(){for(let a=0;a<this.renderTargetsHorizontal.length;a++)this.renderTargetsHorizontal[a].dispose();for(let a=0;a<this.renderTargetsVertical.length;a++)this.renderTargetsVertical[a].dispose();this.renderTargetBright.dispose();for(let a=0;a<this.separableBlurMaterials.length;a++)this.separableBlurMaterials[a].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(a,e){let f=Math.round(a/2),g=Math.round(e/2);this.renderTargetBright.setSize(f,g);for(let x=0;x<this.nMips;x++)this.renderTargetsHorizontal[x].setSize(f,g),this.renderTargetsVertical[x].setSize(f,g),this.separableBlurMaterials[x].uniforms.invSize.value=new se(1/f,1/g),f=Math.round(f/2),g=Math.round(g/2)}render(a,e,f,g,x){a.getClearColor(this._oldClearColor),this.oldClearAlpha=a.getClearAlpha();const C=a.autoClear;a.autoClear=!1,a.setClearColor(this.clearColor,0),x&&a.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=f.texture,a.setRenderTarget(null),a.clear(),this.fsQuad.render(a)),this.highPassUniforms.tDiffuse.value=f.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,a.setRenderTarget(this.renderTargetBright),a.clear(),this.fsQuad.render(a);let l=this.renderTargetBright;for(let p=0;p<this.nMips;p++)this.fsQuad.material=this.separableBlurMaterials[p],this.separableBlurMaterials[p].uniforms.colorTexture.value=l.texture,this.separableBlurMaterials[p].uniforms.direction.value=pe.BlurDirectionX,a.setRenderTarget(this.renderTargetsHorizontal[p]),a.clear(),this.fsQuad.render(a),this.separableBlurMaterials[p].uniforms.colorTexture.value=this.renderTargetsHorizontal[p].texture,this.separableBlurMaterials[p].uniforms.direction.value=pe.BlurDirectionY,a.setRenderTarget(this.renderTargetsVertical[p]),a.clear(),this.fsQuad.render(a),l=this.renderTargetsVertical[p];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,a.setRenderTarget(this.renderTargetsHorizontal[0]),a.clear(),this.fsQuad.render(a),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,x&&a.state.buffers.stencil.setTest(!0),this.renderToScreen?(a.setRenderTarget(null),this.fsQuad.render(a)):(a.setRenderTarget(f),this.fsQuad.render(a)),a.setClearColor(this._oldClearColor,this.oldClearAlpha),a.autoClear=C}getSeperableBlurMaterial(a){const e=[];for(let f=0;f<a;f++)e.push(.39894*Math.exp(-.5*f*f/(a*a))/a);return new _e({defines:{KERNEL_RADIUS:a},uniforms:{colorTexture:{value:null},invSize:{value:new se(.5,.5)},direction:{value:new se(.5,.5)},gaussianCoefficients:{value:e}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {
					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(a){return new _e({defines:{NUM_MIPS:a},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}pe.BlurDirectionX=new se(1,0);pe.BlurDirectionY=new se(0,1);class ct extends cr{constructor(a,e,f=null,g=null,x=null){super(),this.scene=a,this.camera=e,this.overrideMaterial=f,this.clearColor=g,this.clearAlpha=x,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Ce}render(a,e,f){const g=a.autoClear;a.autoClear=!1;let x,C;this.overrideMaterial!==null&&(C=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(a.getClearColor(this._oldClearColor),a.setClearColor(this.clearColor)),this.clearAlpha!==null&&(x=a.getClearAlpha(),a.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&a.clearDepth(),a.setRenderTarget(this.renderToScreen?null:f),this.clear===!0&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),a.render(this.scene,this.camera),this.clearColor!==null&&a.setClearColor(this._oldClearColor),this.clearAlpha!==null&&a.setClearAlpha(x),this.overrideMaterial!==null&&(this.scene.overrideMaterial=C),a.autoClear=g}}export{ct as R,pe as U,ut as t};
